<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Three.js Constellations</title>
    <script type="importmap">
      {
        "imports": {
          "three": "https://cdn.jsdelivr.net/npm/three@<version>/build/three.module.js",
          "three/addons/": "https://cdn.jsdelivr.net/npm/three@<version>/examples/jsm/"
        }
      }
    </script>
    <style>
      body {
        margin: 0;
      }
      canvas {
        display: block;
      }
    </style>
  </head>
  <body>
    <script type="module">
      import * as THREE from 'three';

      // Create the scene
      const scene = new THREE.Scene();

      // Create the camera
      const camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      camera.position.z = 20;

      // Create the renderer
      const renderer = new THREE.WebGLRenderer();
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      // Define the constellations
      const constellations = {
        orion: {
          stars: [
            { x: 2.0, y: 2.5, z: 0 },
            { x: 3.0, y: 1.0, z: 0 },
            { x: 1.0, y: -1.0, z: 0 },
            { x: 2.0, y: -1.5, z: 0 },
            { x: 3.0, y: -1.0, z: 0 },
            { x: 4.0, y: -2.0, z: 0 },
          ],
          connections: [
            [0, 1],
            [1, 2],
            [2, 3],
            [3, 4],
            [4, 5],
          ],
        },
        ursamajor: {
          stars: [
            { x: 5.0, y: 5.0, z: 0 },
            { x: 6.0, y: 4.5, z: 0 },
            { x: 7.0, y: 4.0, z: 0 },
            { x: 8.0, y: 3.5, z: 0 },
            { x: 9.0, y: 4.0, z: 0 },
            { x: 10.0, y: 4.5, z: 0 },
            { x: 11.0, y: 5.0, z: 0 },
          ],
          connections: [
            [0, 1],
            [1, 2],
            [2, 3],
            [3, 4],
            [4, 5],
            [5, 6],
          ],
        },
      };

      // Function to create stars and lines
      function createConstellation(constellation) {
        // Create stars
        const starsGeometry = new THREE.BufferGeometry();
        const starMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 0.3 });

        const starPositionsArray = [];
        constellation.stars.forEach((star) => {
          starPositionsArray.push(star.x, star.y, star.z);
        });

        starsGeometry.setAttribute(
          'position',
          new THREE.Float32BufferAttribute(starPositionsArray, 3)
        );
        const stars = new THREE.Points(starsGeometry, starMaterial);
        scene.add(stars);

        // Create lines
        const lineMaterial = new THREE.LineBasicMaterial({ color: 0xffffff });
        constellation.connections.forEach((connection) => {
          const lineGeometry = new THREE.BufferGeometry();
          const points = [
            new THREE.Vector3(
              constellation.stars[connection[0]].x,
              constellation.stars[connection[0]].y,
              constellation.stars[connection[0]].z
            ),
            new THREE.Vector3(
              constellation.stars[connection[1]].x,
              constellation.stars[connection[1]].y,
              constellation.stars[connection[1]].z
            ),
          ];
          lineGeometry.setFromPoints(points);
          const line = new THREE.Line(lineGeometry, lineMaterial);
          scene.add(line);
        });
      }

      // Create constellations
      createConstellation(constellations.orion);
      createConstellation(constellations.ursamajor);

      // Add an axis helper to see the origin
      const axesHelper = new THREE.AxesHelper(5);
      scene.add(axesHelper);

      // Render loop
      function animate() {
        requestAnimationFrame(animate);

        renderer.render(scene, camera);
      }

      animate();

      // Handle window resize
      window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });
    </script>
  </body>
</html>
